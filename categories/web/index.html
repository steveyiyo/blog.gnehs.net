<!doctype html><html lang><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><title>web - 勝勝</title><meta name=description content><meta name=author content="勝勝"><link href=https://blog.gnehs.net/an-old-hope.min.css rel=stylesheet><link href=https://blog.gnehs.net/style.css rel=stylesheet><link href=https://blog.gnehs.net/custom.css rel=stylesheet><link rel=apple-touch-icon href=/favicon.png><link rel=icon href=/favicon.png><meta name=generator content="Hugo 0.81.0"><link rel=alternate type=application/rss+xml href=https://blog.gnehs.net/categories/web/index.xml title=勝勝><script>function setTheme(){if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');return}const c=new Date,g=localStorage.getItem('date'),d=String(c.getMonth()+1)+'.'+String(c.getDate()),e=c.getTime();let a,b;function f(){if(e>a&&e<b)return;document.body.classList.add('dark')}d!==g?(fetch('https://api.ipgeolocation.io/astronomy?apiKey=5ed37d85103e4defa5df4c5298ed5215').then(a=>a.json()).then(c=>{a=c.sunrise.split(':').map(Number),b=c.sunset.split(':').map(Number)}).catch(()=>{a=[7,0],b=[19,0]}).finally(()=>{a=c.setHours(a[0],a[1],0),b=c.setHours(b[0],b[1],0),f(),localStorage.setItem('sunrise',a),localStorage.setItem('sunset',b)}),localStorage.setItem('date',d)):(a=Number(localStorage.getItem('sunrise')),b=Number(localStorage.getItem('sunset')),f())}</script></head><body class=list><script>setTheme()</script><header class=header><nav class=nav><p class=logo><a href=https://blog.gnehs.net>勝勝</a></p><ul class=menu><li><a href=/categories/>categories</a></li><li><a href=/tags/>tags</a></li><li><a href=/about/>about</a></li></ul></nav></header><main class=main><header class=page-header><h1>web</h1></header><article class=post-entry><header class=entry-header><h2>如何使用 Javascript 將多部影片混合為一個影片</h2></header><section class=entry-content><p>最近在製作 How 發聲器 因為影片每個發音播放時都會有間隙，超討厭，但 How哥產生器 聽說是用 ffmpeg 來做輸出，要後端而且看起來很燒錢，所以在尋找純前端的做法。
我先說，這真的有夠搞剛，超級無敵麻煩，另外，如果你用 Node.js 用 fluent-ffmpeg 就好了。
在尋找的時候看到這個 How do i append two video files data to a source buffer using media source api? ，而且下面的 解法 還會動，甚至支援不同尺寸影片混合，所以我把它偷過來就好了嗎。
錯誤！ 他根本不會動，只知道不停地噴錯，明明我放的跟他一樣都是 MP4，我完全不知道他 Demo 怎麼會動 解法 在網路上尋找不同解法後，看了這篇文章「Transcoding assets for Media Source Extensions」，發現是 MP4 少了幾個 Flag 以及 codec 要自己拿 MP4Box 看了之後填進程式碼，拿 ffmpeg 處理過後就會動了。
結果處理時加這行就好了 -movflags frag_keyframe+empty_moov+default_base_moof ，害我花了快半天，真棒 Demo 你可以使用 Chrome 查看 How 發聲器
雖然有點音聲不同步，算了隨便啦...</p></section><footer class=entry-footer><time>2020 年 06 月 06 日</time></footer><a class=entry-link href=https://blog.gnehs.net/js-merge-video/></a></article><article class=post-entry><header class=entry-header><h2>透過 JS 即時偵測系統外觀是否處於深色模式</h2></header><section class=entry-content><p>在撰寫網頁時若要用 JS 來檢測系統的主題，你會需要用到 CSS 的 prefers-color-scheme: dark 來檢測是否適用於該條規則，我們可以在 js 使用 matchMedia 來查看檢測後的結果。
程式碼如下
const darkModeMediaQuery = window.matchMedia(`(prefers-color-scheme: dark)`); darkModeMediaQuery.addListener(e => { //當系統變更主題時都會執行這裡 const darkMode = e.matches; // darkMode: [true(深色主題開啟)|false(深色主題關閉)] }); ...</p></section><footer class=entry-footer><time>2019 年 12 月 14 日</time></footer><a class=entry-link href=https://blog.gnehs.net/js-detect-dark-mode/></a></article><article class=post-entry><header class=entry-header><h2>一起來幫網站加入 reCAPTCHA 吧</h2></header><section class=entry-content><p>reCAPTCHA 是眾所皆知的工人 OCR 驗證系統，在 v3 中，直接由分數判斷是否是機器人，因此也不需要核取方塊了。
最近在幫 Telegram 蒐集君 寫提交工具，因為驗證碼很麻煩，自己也懶得打所以直接拿 reCAPTCHA 來用了，由於使用 XHR 提交資料，因此 reCAPTCHA 的部分需要稍稍改寫才能夠正常運作。
始步：在 reCAPTCHA 註冊新的網站 要使用 reCAPTCHA，必須要先到 Google 註冊才能夠使用，以下是註冊流程。
註冊新網站：https://www.google.com/recaptcha/admin/create
標籤：填入自己方便記憶的名稱即可
類型：選 v3
網域：輸入自己要用的網域，如果你要在本地測試，可以再加上 localhost
全部輸入完成後按下下方的「提交」即可
註冊完成後，你會拿到兩串金鑰，請好好保存，其中密鑰不能給他人知道。
加入 reCAPTCHA 到前端頁面吧！ 把下面的程式碼貼到你的網頁中吧！別忘了將 reCAPTCHA_site_key 換成你的網站金鑰
&lt;script src="https://www.google.com/recaptcha/api.js?render=reCAPTCHA_site_key">&lt;/script> &lt;script> grecaptcha.ready(function() { grecaptcha.execute('reCAPTCHA_site_key', {action: 'homepage'}).then(token => { //這裡拿到的 token 要在 XHR 請求時也發給伺服器驗證 }); }); &lt;/script> 完成後，應該就能在網頁右下角看見 reCAPTCHA 的標誌了
完成後端驗證 發送請求的方式百百種，因為我的後端語言用 node.js 所以就拿 request-promise 來送請求。
*請自行修改程式碼以符合需求
const rp = require("request-promise") let result = await rp({ method: 'post', uri: "https://www....</p></section><footer class=entry-footer><time>2019 年 05 月 05 日</time></footer><a class=entry-link href=https://blog.gnehs.net/tg-submit-recaptcha/></a></article><article class=post-entry><header class=entry-header><h2>YouTube 字幕特效是如何製作的？</h2></header><section class=entry-content><p>因為時不時可以在一些 MV 裡看見一些很庫蹦來蹦去的字幕，於是便上網搜尋，了解後發現 YouTube 用了 webVTT 當作字幕好朋友來用，可以隨意更改位置和大小，看起來應該是類似 SRT 那樣。
像是這首 和這首 若要為 YouTube 上的字幕改一點位置，利用 youtube-dl 把字幕下載下來後就可以來亂改位置了
youtube-dl --skip-download --sub-format vtt --write-sub --sub-lang zh-TW &lt;link> 字幕搞下來後拿個編輯器打開就可以改了
00:00:00.000 --> 00:00:07.075 這是原本的字幕 00:00:00.000 --> 00:00:07.075 align:left size:35% position:0% 在時間後方加上一些樣式便會移到左方了，喔對每行時間都要加 W3C 裡面還有更詳細的說明，像是可以像 CSS 那樣幫每段字幕加上 class 來套用相同的樣式。
參考資料 How to change the positioning of captions in YouTube https://medium.com/@mlockrey/how-to-change-the-positioning-of-captions-in-youtube-c75bb9ac0aff
WebVTT: The Web Video Text Tracks Format https://w3c....</p></section><footer class=entry-footer><time>2019 年 01 月 29 日</time></footer><a class=entry-link href=https://blog.gnehs.net/youtube-webvtt/></a></article><br><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-6834090314855499 data-ad-slot=2767030263></ins></main><footer class=footer><span>&copy; 2021 <a href=https://blog.gnehs.net>勝勝</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel=noopener target=_blank>Hugo️️</a>️</span>
<span>&#183;</span>
<span>Theme️ <a href=https://github.com/nanxiaobei/hugo-paper rel=noopener target=_blank>Paper</a></span></footer><script src=https://blog.gnehs.net/highlight.min.js></script><script>hljs.initHighlightingOnLoad()</script><script async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-96NRMGGV7E"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-96NRMGGV7E')</script></body></html>